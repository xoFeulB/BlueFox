(()=>{"use strict";const t=(e,o,r=".")=>{let s=e.split(r)[0],n=e.split(r).slice(1).join(r);if(null!=o[s]){let i=t(n,o[s],r);return!0===i?{object:o,property:s,path:e,separator:r,value:o[s]}:i}return e==n};class e{constructor(){this.J=null,this.take=[],this.actions=null,this.dispatchEvents=null,this.msec=null,this.sleep=t=>new Promise((e=>setTimeout(e,t))),this.actionHandler={set:async e=>{let o=document.querySelector(e.target);if(o){if(e.property)for(let r in e.property){let s=t(r,o);if(s.object){s.object[s.property]=e.property[r];for(let t of this.dispatchEvents)o.dispatchEvent(new Event(t,{bubbles:!0}))}}if(e.attribute)for(let t in e.attribute){o.setAttribute(t,e.attribute[t]);for(let t of this.dispatchEvents)o.dispatchEvent(new Event(t,{bubbles:!0}))}}},take:async e=>{let o=document.querySelector(e.target);if(o){let r=e;if(e.property){let s={};for(let r in e.property){let e=t(r,o);e.object&&(s[r]=e.object[e.property])}Object.assign(r,{property:s})}if(e.attribute){let t={};for(let r in e.attribute)t[r]=o.getAttribute(r);Object.assign(r,{attribute:t})}this.take.push(r)}},eval:async e=>{let o=document.querySelector(e.target);if(o&&e.property)for(let r in e.property){let s=t(r,o);s.object&&s.object[s.property](e.property[r])}},capture:async t=>{let e=document.querySelector(t.target);if(e)try{await this.captureDOM(t.fileName,e,window,t.format,t.quality)}catch{}},sleep:async t=>{await this.sleep(t.target)},event:async t=>{let e=document.querySelector(t.target);e&&e.dispatchEvent(new Event(t.dispatchEvent,{bubbles:!0}))},save:async t=>{let e=this.J;Object.assign(e,{takes:this.take}),Object.assign(document.createElement("a"),{href:window.URL.createObjectURL(new Blob([JSON.stringify(e)],{type:"application/json"})),download:`${t.fileName}.json`}).click(),this.take=[]}}}async do(t){this.J=t,this.take=[],this.actions=t.actions,this.dispatchEvents=t.dispatchEvents,this.msec=t.sleep;for(let t of this.actions)await this.actionHandler[t.type](t),0!=this.msec&&await this.sleep(this.msec);return Object.assign(t,{stack:this.take})}}class o{constructor(){this.J=null,this.stack=[],this.actions=null,this.dispatchEvents=null,this.msec=null,this.focus=document,this.sleep=t=>new Promise((e=>setTimeout(e,t))),this.actionHandler={set:async e=>{let o=this.focus.querySelector(e.target.selector);if(o){if(e?.target?.property){let r=t(e.target.property,o);r.object&&(o=r.object[r.property])}if(e?.option?.property)for(let r in e.option.property){let s=t(r,o);if(s.object){s.object[s.property]=e.option.property[r];for(let e of this.dispatchEvents){let r=t(e.option.eventObject,window),s=r.object[r.property];o.dispatchEvent(new s(e.option.eventType,e.option.eventArgs))}}}if(e?.option?.attribute)for(let r in e.option.attribute){o.setAttribute(r,e.option.attribute[r]);for(let e of this.dispatchEvents){let r=t(e.option.eventObject,window),s=r.object[r.property];o.dispatchEvent(new s(e.option.eventType,e.option.eventArgs))}}}},push:async e=>{let o=this.focus.querySelector(e.target.selector);if(o){if(e?.target?.property){let r=t(e.target.property,o);r.object&&(o=r.object[r.property])}let r=e;if(e?.option?.property){let s={};for(let r in e.option.property){let e=t(r,o);e.object&&(s[r]=e.object[e.property])}Object.assign(r.option,{property:s})}if(e?.option?.attribute){let t={};for(let r in e.option.attribute)t[r]=o.getAttribute(r);Object.assign(r.option,{attribute:t})}this.stack.push(r)}},call:async e=>{let o=this.focus.querySelector(e.target.selector);if(o){let r=t(e.target.property,o);r.object&&(e?.option?r.object[r.property](e?.option):r.object[r.property]())}},event:async e=>{let o=this.focus.querySelector(e.target.selector);if(o)if(e?.target?.property){let r=t(e.target.property,o);if(r.object){let o=t(e.option.eventObject,window),s=o.object[o.property];r.object[r.property].dispatchEvent(new s(e.option.eventType,Object.assign({target:r.object[r.property],view:window},e.option.eventArgs)))}}else{let r=t(e.option.eventObject,window),s=r.object[r.property];o.dispatchEvent(new s(e.option.eventType,Object.assign({target:o,view:window},e.option.eventArgs)))}},key:async t=>{try{await this.dispatchKeyEvent(t.option)}catch(t){}},sleep:async t=>{await this.sleep(t.option.msec)},open:async t=>{window.location.assign(t.option.url)},focus:async e=>{let o=this.focus.querySelector(e.target.selector);if(o)if(e?.target?.property){let r=t(e.target.property,o);r.object&&(this.focus=r.object[r.property])}else this.focus=o;e?.target?.reset&&(this.focus=document)},capture:async e=>{let o=this.focus.querySelector(e.target.selector);if(o){if(e?.target?.property){let r=t(e.target.property,o);r.object&&(o=r.object[r.property])}try{await this.captureDOM(e.option.fileName,o,window,e.option.format,e.option.quality)}catch(t){}}},save:async t=>{let e=this.J;Object.assign(e,{stack:this.stack}),Object.assign(this.focus.createElement("a"),{href:window.URL.createObjectURL(new Blob([JSON.stringify(e,null,4)],{type:"application/json"})),download:`${t.option.fileName}.json`}).click(),this.stack=[]}}}async do(t){this.J=t,this.stack=[],this.actions=t.actions,this.dispatchEvents=t.dispatchEvents,this.msec=t.sleep;for(let t of this.actions)await this.actionHandler[t.type](t),0!=this.msec&&await this.sleep(this.msec);return Object.assign(t,{stack:this.stack})}}const r=t=>{const e=Object.getOwnPropertyNames(t);for(const o of e){const e=t[o];e&&"object"==typeof e&&r(e)}return Object.freeze(t)},s=t=>{if("object"!=typeof t)return[];let e=[];for(let o in t){let r=t[o];if("object"==typeof r)s(r).forEach((t=>{e.push({path:[o,t.path].flat(),value:t.value,type:typeof t.value})}));else{let t={path:o,value:r,type:typeof r};e.push(t)}}return e},n=async(t={_scope_:null})=>{let e=[];return Object.keys(t).filter((t=>!["_scope_"].includes(t))).forEach((o=>{[...t._scope_.querySelectorAll(o)].filter((t=>t)).forEach((t=>{e.push({element:t,selector:new String(o)})}))})),await Promise.all(e.map((e=>new Promise((async(o,r)=>{try{await t[e.selector]({element:e.element,selector:e.selector,self:t}),o(e.selector)}catch(t){console.info("walkHorizontally |",t)}}))))),t},i=async(t={_scope_:null})=>{for(let e of Object.keys(t).filter((t=>!["_scope_"].includes(t)))){let o=[...t._scope_.querySelectorAll(e)].filter((t=>t));for(let r of o)try{await t[e]({element:r,selector:new String(e),self:t})}catch(t){console.info("walkVertically |",t)}}return t},c=r({Automation:{BlueFox:class{async do(t){return await{0:async()=>{let o=new e;return o.captureDOM=this.captureDOM,await o.do(t)},1:async()=>{let e=new o;return e.captureDOM=this.captureDOM,e.dispatchKeyEvent=this.dispatchKeyEvent,await e.do(t)}}[t.meta.version]()}}},Util:{getProperty:t,getAllPath:s},Walker:{walkHorizontally:n,walkVertically:i},Sync:{view:async(e=document)=>{await n({_scope_:e,"[capture]":async t=>{let e=document.querySelector(t.element.attributes.capture.value).tagName.toLowerCase();t.element.setAttribute("sync",""),t.element.setAttribute("sync-to-this",""),"input"==e?(t.element.setAttribute("sync-to-property","textContent"),t.element.setAttribute("sync-from",t.element.attributes.capture.value),t.element.setAttribute("sync-from-property","value"),t.element.setAttribute("sync-event",JSON.stringify(["sync","change","input"]))):"select"==e&&(t.element.setAttribute("sync-to-property","textContent"),t.element.setAttribute("sync-from",t.element.attributes.capture.value),t.element.setAttribute("sync-from-property","selectedOptions.0.textContent"),t.element.setAttribute("sync-event",JSON.stringify(["sync","change"]))),t.element.removeAttribute("capture")}}),await i({_scope_:e,"[sync]":async e=>{let o=()=>{r()},r=()=>{e.element.SyncView={from:e.element.attributes["sync-from-this"]?e.element:document.querySelector(e.element.attributes["sync-from"].value),fromProperty:e.element.attributes["sync-from-property"].value,to:e.element.attributes["sync-to-this"]?e.element:document.querySelector(e.element.attributes["sync-to"].value),toProperty:e.element.attributes["sync-to-property"].value,events:JSON.parse(e.element.attributes["sync-event"]?e.element.attributes["sync-event"].value:'["sync"]'),entryNop:e.element.attributes["sync-entry-nop"],init:o},e.element.SyncView.sync=()=>{let o=t(e.element.SyncView.fromProperty,e.element.SyncView.from),r=t(e.element.SyncView.toProperty,e.element.SyncView.to);try{r.object[r.property]=o.object[o.property]}catch{}},!e.element.SyncView.entryNop&&e.element.SyncView.sync(),e.element.SyncView.events.forEach((t=>{e.element.SyncView.from.addEventListener(t,(t=>{e.element.SyncView.sync(),e.element.SyncView.to.dispatchEvent(new Event("sync"))}))}))};o()},sync:async e=>{e.element.SyncView={Syncs:[]};let o=JSON.parse(e.element.textContent),r=t=>{s(t)},s=o=>{let s=o.separator?o.separator:".",n=o.from.split(s),i=o.to.split(s),c=o.events,a=e.self._scope_.querySelector(n[0]),l=e.self._scope_.querySelector(i[0]),p={separator:s,from:a,fromProperty:n.slice(1).join(s),to:l,toProperty:i.slice(1).join(s),events:c,entryNop:o.entryNop,init:r,sync:()=>{let e=t(p.fromProperty,p.from,p.separator),o=t(p.toProperty,p.to,p.separator);try{o.object[o.property]=e.object[e.property]}catch{}}};p.events.forEach((t=>{p.from.addEventListener(t,(t=>{p.sync(),p.to.dispatchEvent(new Event("sync"))}))})),!p.entryNop&&p.sync(),e.element.SyncView.Syncs.push(p)};Array.prototype==o.__proto__&&o.forEach((t=>{r(t)})),Object.prototype==o.__proto__&&r(o)}})},value:async(t={},e=document)=>{let o={values:{},flesh:()=>{Object.keys(o.values).forEach((t=>{o.values[`${t}`].setTextContent(o.values[t].value),o.values[`${t}`].setValue(o.values[t].value)}))}};return Object.keys(t).forEach((r=>{o.values[`${r}`]={value:t[r],origin:t[r],setTextContent:t=>{o.values[r].value=t,[...e.querySelectorAll(`[setTextContent="${r}"]`)].forEach((e=>{e.textContent=t}))},setValue:t=>{o.values[r].value=t,[...e.querySelectorAll(`[setValue="${r}"]`)].forEach((e=>{e.value=t}))}},o.values[`${r}`].setTextContent(t[r]),o.values[`${r}`].setValue(t[r])})),o}}});window.dispatchEvent(new CustomEvent("BlueFoxJs@Ready",{detail:{BlueFoxJs:c}}))})();